<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Provider Interface Reference | LLxprt Code Docs</title>
  <link rel="stylesheet" href="../../../vybestack.css" />
</head>
<body>

  <nav>
    <div class="nav-container">
      <div class="nav-left">
        <a href="/" class="logo">
          <img src="/assets/vybestack_logo.png" alt="Vybestack" />
        </a>
        <span class="tagline">Beyond Vibe Coding</span>
      </div>
      <div class="nav-right">
        <a href="/llxprt-code.html">LLxprt Code</a>
        <a href="/jefe.html">LLxprt Jefe</a>
        <a href="/llxprt-code/docs/">Docs</a>
        <a href="/blog/">Blog</a>
        <a href="/#podcast">Podcast</a>
        <a href="https://discord.gg/Wc6dZqWWYv" target="_blank">Discord</a>
      </div>
    </div>
  </nav>


  <section class="section docs-section">
    <div class="container-wide">
      <div class="docs-layout">

      <nav class="docs-sidebar">
        <h3><a href="/llxprt-code/docs/">Documentation</a></h3>
        <ul>
          <li><a href="/llxprt-code/docs/getting-started.html">Getting Started Guide</a></li>
          <li><a href="/llxprt-code/docs/cli/providers.html">Provider Configuration</a></li>
          <li><a href="/llxprt-code/docs/cli/authentication.html">Authentication</a></li>
          <li><a href="/llxprt-code/docs/cli/profiles.html">Profiles</a></li>
          <li><a href="/llxprt-code/docs/sandbox.html">Sandboxing</a></li>
          <li><a href="/llxprt-code/docs/subagents.html">Subagents</a></li>
          <li><a href="/llxprt-code/docs/oauth-setup.html">OAuth Setup</a></li>
          <li><a href="/llxprt-code/docs/local-models.html">Local Models</a></li>
          <li><a href="/llxprt-code/docs/zed-integration.html">Zed Editor Integration</a></li>
          <li><a href="/llxprt-code/docs/cli/providers-openai-responses.html">OpenAI Responses API</a></li>
          <li><a href="/llxprt-code/docs/prompt-configuration.html">Prompt Configuration</a></li>
          <li><a href="/llxprt-code/docs/settings-and-profiles.html">Settings and Profiles</a></li>
          <li><a href="/llxprt-code/docs/checkpointing.html">Checkpointing</a></li>
          <li><a href="/llxprt-code/docs/extension.html">Extensions</a></li>
          <li><a href="/llxprt-code/docs/ide-integration.html">IDE Integration</a></li>
          <li><a href="/llxprt-code/docs/cli/configuration.html">Configuration</a></li>
          <li><a href="/llxprt-code/docs/cli/commands.html">Commands Reference</a></li>
          <li><a href="/llxprt-code/docs/troubleshooting.html">Troubleshooting Guide</a></li>
          <li><a href="/llxprt-code/docs/cli/index.html">CLI Introduction</a></li>
          <li><a href="/llxprt-code/docs/deployment.html">Execution and Deployment</a></li>
          <li><a href="/llxprt-code/docs/keyboard-shortcuts.html">Keyboard Shortcuts</a></li>
          <li><a href="/llxprt-code/docs/cli/themes.html">Themes</a></li>
          <li><a href="/llxprt-code/docs/EMOJI-FILTER.html">Emoji Filter</a></li>
          <li><a href="/llxprt-code/docs/cli/runtime-helpers.html">Runtime helper APIs</a></li>
          <li><a href="/llxprt-code/docs/cli/context-dumping.html">Context Dumping</a></li>
          <li><a href="/llxprt-code/docs/telemetry.html">Telemetry</a></li>
          <li><a href="/llxprt-code/docs/telemetry-privacy.html">Telemetry Privacy</a></li>
          <li><a href="/llxprt-code/docs/gemini-cli-tips.html">Migration from Gemini CLI</a></li>
          <li><a href="/llxprt-code/docs/architecture.html">Architecture Overview</a></li>
          <li><a href="/llxprt-code/docs/core/index.html">Core Introduction</a></li>
          <li><a href="/llxprt-code/docs/core/provider-runtime-context.html">Provider runtime context</a></li>
          <li><a href="/llxprt-code/docs/core/provider-interface.html">Provider interface</a></li>
          <li><a href="/llxprt-code/docs/core/tools-api.html">Tools API</a></li>
          <li><a href="/llxprt-code/docs/core/memport.html">Memory Import Processor</a></li>
          <li><a href="/llxprt-code/docs/shell-replacement.html">Shell Replacement</a></li>
          <li><a href="/llxprt-code/docs/../CONTRIBUTING.html">Contributing & Development Guide</a></li>
          <li><a href="/llxprt-code/docs/npm.html">NPM Workspaces and Publishing</a></li>
          <li><a href="/llxprt-code/docs/migration/stateless-provider.html">Stateless provider migration</a></li>
          <li><a href="/llxprt-code/docs/tools/index.html">Tools Overview</a></li>
          <li><a href="/llxprt-code/docs/tools/file-system.html">File System Tools</a></li>
          <li><a href="/llxprt-code/docs/tools/multi-file.html">Multi-File Read Tool</a></li>
          <li><a href="/llxprt-code/docs/tools/shell.html">Shell Tool</a></li>
          <li><a href="/llxprt-code/docs/tools/mcp-server.html">MCP Server</a></li>
          <li><a href="/llxprt-code/docs/tools/web-fetch.html">Web Fetch Tool</a></li>
          <li><a href="/llxprt-code/docs/tools/web-search.html">Web Search Tool</a></li>
          <li><a href="/llxprt-code/docs/tools/memory.html">Memory Tool</a></li>
          <li><a href="/llxprt-code/docs/release-notes/stateless-provider.html">Release notes: Stateless Provider</a></li>
          <li><a href="/llxprt-code/docs/tos-privacy.html">Terms of Service and Privacy Notice</a></li>
        </ul>
      </nav>
        <div class="docs-content">
          <div class="blog-post-content">
            <h1>Provider Interface Reference</h1>
<p>The stateless provider architecture introduces an explicit runtime contract for provider implementations. This document summarises the updated interface exposed from <code>@vybestack/llxprt-code-core</code>.</p>
<h2><code>GenerateChatOptions</code></h2>
<pre><code class="language-ts">export interface GenerateChatOptions {
  contents: IContent[];
  tools?: ProviderToolset;
  settings?: SettingsService;
  config?: Config;
  runtime?: ProviderRuntimeContext;
  metadata?: Record&lt;string, unknown&gt;;
}
</code></pre>
<ul>
<li><strong><code>settings</code></strong> – scoped <code>SettingsService</code> bound to the caller. Prefer this over importing global helpers.</li>
<li><strong><code>config</code></strong> – optional <code>Config</code> instance with helper methods (<code>getProvider</code>, <code>setEphemeralSetting</code>, etc.).</li>
<li><strong><code>runtime</code></strong> – the full <code>ProviderRuntimeContext</code>. It always includes the <code>settingsService</code> and may include <code>runtimeId</code> or <code>metadata</code> that callers can use for logging.</li>
<li><strong><code>metadata</code></strong> – arbitrary caller-supplied data (for example, CLI feature flags or subagent identifiers).</li>
</ul>
<p>Providers should treat <code>runtime</code> as authoritative. Fallback to <code>getActiveProviderRuntimeContext()</code> only when running inside legacy tests.</p>
<h2>Mandatory methods</h2>
<pre><code class="language-ts">interface IProvider {
  name: string;
  isDefault?: boolean;
  getModels(): Promise&lt;IModel[]&gt;;
  generateChatCompletion(
    options: GenerateChatOptions,
  ): AsyncIterableIterator&lt;IContent&gt;;
  getDefaultModel(): string;
  getServerTools(): string[];
  invokeServerTool(
    toolName: string,
    params: unknown,
    config?: unknown,
  ): Promise&lt;unknown&gt;;
}
</code></pre>
<ul>
<li><code>generateChatCompletion</code> must respect the options object and stream responses through the returned async iterator.</li>
<li><code>getModels</code> and <code>getDefaultModel</code> should read model lists from the provider's metadata or remote API.</li>
<li><code>getServerTools</code> and <code>invokeServerTool</code> expose provider-native capabilities (tool calling, image generation, etc.).</li>
</ul>
<h2>Deprecated hooks</h2>
<p>The following methods remain on the interface for backward compatibility but should be avoided in new code:</p>
<ul>
<li><code>setConfig(config)</code> – prefer passing <code>config</code> via <code>GenerateChatOptions</code>.</li>
<li><code>clearState()</code> – maintain state in the runtime scope instead.</li>
<li><code>clearAuth()</code> / <code>clearAuthCache()</code> – authentication is managed by runtime-scoped handlers.</li>
</ul>
<h2>Stateless runtime requirements</h2>
<!-- @plan:PLAN-20251023-STATELESS-HARDENING.P09 @requirement:REQ-SP4-002 @requirement:REQ-SP4-004 -->
<ul>
<li>Treat every invocation as isolated. Instantiate API clients, loggers, and tool formatters inside <code>generateChatCompletion</code> rather than storing them on the class or module scope. ProviderManager enforces this by running <code>prepareStatelessProviderInvocation()</code> before your method executes.</li>
<li>Use the normalized <code>options.resolved</code> object for <code>model</code>, <code>baseURL</code>, and <code>authToken</code>. These values already respect runtime-scoped overrides, so avoid recomputing or memoizing them.</li>
<li>Never import singleton helpers like <code>getSettingsService()</code>. The supplied <code>options.settings</code> and <code>options.runtime?.settingsService</code> are the only supported sources, and guards (<code>MissingProviderRuntimeError</code> / <code>ProviderRuntimeNormalizationError</code>) will throw if you attempt to run without them.</li>
<li>If you expose cache-clearing helpers (for CLI compatibility), keep them as no-ops. Per-call instantiation makes cache eviction unnecessary, and retaining the method signature simply avoids breaking existing commands.</li>
</ul>
<h2>Accessing runtime information</h2>
<p>Provider implementations typically pull runtime data from <code>options.runtime</code>:</p>
<pre><code class="language-ts">async *generateChatCompletion(options: GenerateChatOptions) {
  const runtime = options.runtime ?? getActiveProviderRuntimeContext();
  const settings = runtime.settingsService;
  const apiKey = settings.getProviderSetting(this.name, 'apiKey');
  const baseUrl = settings.getProviderSetting(this.name, 'baseUrl');
  // ... build request using runtime data ...
  yield* sendRequest(apiKey, baseUrl, options.contents, options.tools);
}
</code></pre>
<p>Use <code>runtime.metadata</code> for enriched logging or telemetry, and respect any model parameters stored on the <code>SettingsService</code> (for example, temperature overrides).</p>
<h2>Testing tips</h2>
<ul>
<li>Create isolated contexts for each test using <code>createProviderRuntimeContext()</code> and set it active with <code>setActiveProviderRuntimeContext()</code>.</li>
<li>Inject fake <code>SettingsService</code> instances into the context to assert how providers read/write configuration.</li>
<li>Leverage <code>resetCliProviderInfrastructure()</code> when testing the CLI integration to avoid cross-test contamination.</li>
</ul>

          </div>
        </div>
      </div>
    </div>
  </section>


  <footer class="footer">
    <div class="footer-container">
      <div class="footer-section">
        <h4>Vybestack</h4>
        <p>Beyond vibe coding. Autonomous development for ascending engineers.</p>
      </div>
      <div class="footer-section">
        <h4>Products</h4>
        <ul>
          <li><a href="/llxprt-code.html">LLxprt Code</a></li>
          <li><a href="/jefe.html">LLxprt Jefe</a></li>
        </ul>
      </div>
      <div class="footer-section">
        <h4>Content</h4>
        <ul>
          <li><a href="/blog/">Blog</a></li>
          <li><a href="/#podcast">Podcast</a></li>
          <li><a href="/llxprt-code/docs/">Documentation</a></li>
        </ul>
      </div>
      <div class="footer-section">
        <h4>Connect</h4>
        <ul class="social-links">
          <li><a href="https://github.com/vybestack/llxprt-code"><img src="/assets/github-mark-white.svg" alt="GitHub" /> </a></li>
          <li><a href="https://discord.gg/Wc6dZqWWYv"><img src="/assets/discord-mark-white.svg" alt="Discord" /></a></li>
          <li><a href="https://www.linkedin.com/company/vybestack/"><img src="/assets/linkedin-white.svg" alt="LinkedIn" /></a></li>
        </ul>
      </div>
    </div>
    <div class="footer-bottom">
      <p>&copy; 2026 Vybestack. Apache 2.0 License. Built for the terminal.</p>
    </div>
  </footer>

</body>
</html>